import arcpy
import os

# Set local variables
workspace = r"C:\Users\abe_lizbethp\Documents\DigitalAcre_LPT\516x_Project\Data"
outWorkspace = r"C:\Users\abe_lizbethp\Documents\DigitalAcre_LPT\516x_Project\516x_Project.gdb"

# Join Sentera Data to layout 
targetFeatures = os.path.join(workspace, "All_Plots.shp")
joinFeatures = os.path.join(workspace, "All_Sentera_w_Corrections.shp")

# Output will be the target features
outfc = os.path.join(outWorkspace, "Layout_w_Sentera")

#Run spatial tool: Intersec Join 
arcpy.analysis.SpatialJoin(targetFeatures, joinFeatures,
                           outfc,
                           "JOIN_ONE_TO_ONE", "KEEP_ALL",
                           'Shape_Leng "Shape_Leng" true true false 19 Double 0 0,First,#,All_Plots,Shape_Leng,-1,-1;Master_ID "Master_ID" true true false 10 Long 0 10,First,#,All_Plots,Master_ID,-1,-1;Plot_Numbe "Plot_Numbe" true true false 10 Long 0 10,First,#,All_Plots,Plot_Numbe,-1,-1;Row_Number "Row_Number" true true false 10 Long 0 10,First,#,All_Plots,Row_Number,-1,-1;Zone_Numbe "Zone_Numbe" true true false 10 Long 0 10,First,#,All_Plots,Zone_Numbe,-1,-1;Plant_Numb "Plant_Numb" true true false 10 Long 0 10,First,#,All_Plots,Plant_Numb,-1,-1;Descriptio "Descriptio" true true false 10 Long 0 10,First,#,All_Plots,Descriptio,-1,-1;Shape_Le_1 "Shape_Le_1" true true false 19 Double 0 0,First,#,All_Plots,Shape_Le_1,-1,-1;Shape_Area "Shape_Area" true true false 19 Double 0 0,First,#,All_Plots,Shape_Area,-1,-1;Duplicate "Duplicate" true true false 5 Long 0 5,First,#,All_Plots,Duplicate,-1,-1;FID_1 "FID_1" true true false 19 Double 0 0,First,#,All_Sentera_w_Corrections,FID_1,-1,-1;Row "Row" true true false 19 Double 0 0,First,#,All_Sentera_w_Corrections,Row,-1,-1;Rep_Num "Rep_Num" true true false 19 Double 0 0,First,#,All_Sentera_w_Corrections,Rep_Num,-1,-1;Notable "Notable" true true false 19 Double 0 0,First,#,All_Sentera_w_Corrections,Notable,-1,-1;First_Dist "First_Dist" true true false 19 Double 0 0,First,#,All_Sentera_w_Corrections,First_Dist,-1,-1;Last_Dist "Last_Dist" true true false 19 Double 0 0,First,#,All_Sentera_w_Corrections,Last_Dist,-1,-1;Prev_Dist "Prev_Dist" true true false 19 Double 0 0,First,#,All_Sentera_w_Corrections,Prev_Dist,-1,-1;Next_Dist "Next_Dist" true true false 19 Double 0 0,First,#,All_Sentera_w_Corrections,Next_Dist,-1,-1;SNext_Dist "SNext_Dist" true true false 19 Double 0 0,First,#,All_Sentera_w_Corrections,SNext_Dist,-1,-1;SNext_ID "SNext_ID" true true false 19 Double 0 0,First,#,All_Sentera_w_Corrections,SNext_ID,-1,-1;SPrev_Dist "SPrev_Dist" true true false 19 Double 0 0,First,#,All_Sentera_w_Corrections,SPrev_Dist,-1,-1;SPrev_ID "SPrev_ID" true true false 19 Double 0 0,First,#,All_Sentera_w_Corrections,SPrev_ID,-1,-1;DNext_Dist "DNext_Dist" true true false 19 Double 0 0,First,#,All_Sentera_w_Corrections,DNext_Dist,-1,-1;DNext_ID "DNext_ID" true true false 19 Double 0 0,First,#,All_Sentera_w_Corrections,DNext_ID,-1,-1;DPrev_Dist "DPrev_Dist" true true false 19 Double 0 0,First,#,All_Sentera_w_Corrections,DPrev_Dist,-1,-1;DPrev_ID "DPrev_ID" true true false 19 Double 0 0,First,#,All_Sentera_w_Corrections,DPrev_ID,-1,-1;Day1Detct "Day1Detct" true true false 80 Text 0 0,First,#,All_Sentera_w_Corrections,Day1Detct,0,80;Day1Area "Day1Area" true true false 19 Double 0 0,First,#,All_Sentera_w_Corrections,Day1Area,-1,-1;Emerge "Emerge" true true false 80 Text 0 0,First,#,All_Sentera_w_Corrections,Emerge,0,80;Day1Angle "Day1Angle" true true false 19 Double 0 0,First,#,All_Sentera_w_Corrections,Day1Angle,-1,-1;Day1Diam "Day1Diam" true true false 19 Double 0 0,First,#,All_Sentera_w_Corrections,Day1Diam,-1,-1;Day1Leaf "Day1Leaf" true true false 19 Double 0 0,First,#,All_Sentera_w_Corrections,Day1Leaf,-1,-1;Day2Detct "Day2Detct" true true false 80 Text 0 0,First,#,All_Sentera_w_Corrections,Day2Detct,0,80;Day2Area "Day2Area" true true false 19 Double 0 0,First,#,All_Sentera_w_Corrections,Day2Area,-1,-1;Day2Angle "Day2Angle" true true false 19 Double 0 0,First,#,All_Sentera_w_Corrections,Day2Angle,-1,-1;Day2Diam "Day2Diam" true true false 19 Double 0 0,First,#,All_Sentera_w_Corrections,Day2Diam,-1,-1;Day2Leaf "Day2Leaf" true true false 19 Double 0 0,First,#,All_Sentera_w_Corrections,Day2Leaf,-1,-1;Day3Detct "Day3Detct" true true false 80 Text 0 0,First,#,All_Sentera_w_Corrections,Day3Detct,0,80;Day3Area "Day3Area" true true false 19 Double 0 0,First,#,All_Sentera_w_Corrections,Day3Area,-1,-1;Day3Angle "Day3Angle" true true false 19 Double 0 0,First,#,All_Sentera_w_Corrections,Day3Angle,-1,-1;Day3Diam "Day3Diam" true true false 19 Double 0 0,First,#,All_Sentera_w_Corrections,Day3Diam,-1,-1;Day3Leaf "Day3Leaf" true true false 19 Double 0 0,First,#,All_Sentera_w_Corrections,Day3Leaf,-1,-1;Day4Detct "Day4Detct" true true false 80 Text 0 0,First,#,All_Sentera_w_Corrections,Day4Detct,0,80;Day4Area "Day4Area" true true false 19 Double 0 0,First,#,All_Sentera_w_Corrections,Day4Area,-1,-1;Day4Angle "Day4Angle" true true false 19 Double 0 0,First,#,All_Sentera_w_Corrections,Day4Angle,-1,-1;Day4Diam "Day4Diam" true true false 19 Double 0 0,First,#,All_Sentera_w_Corrections,Day4Diam,-1,-1;Day4Leaf "Day4Leaf" true true false 19 Double 0 0,First,#,All_Sentera_w_Corrections,Day4Leaf,-1,-1;Day5Detct "Day5Detct" true true false 80 Text 0 0,First,#,All_Sentera_w_Corrections,Day5Detct,0,80;Day5Area "Day5Area" true true false 19 Double 0 0,First,#,All_Sentera_w_Corrections,Day5Area,-1,-1;Day5Angle "Day5Angle" true true false 19 Double 0 0,First,#,All_Sentera_w_Corrections,Day5Angle,-1,-1;Day5Diam "Day5Diam" true true false 19 Double 0 0,First,#,All_Sentera_w_Corrections,Day5Diam,-1,-1;Day5Leaf "Day5Leaf" true true false 19 Double 0 0,First,#,All_Sentera_w_Corrections,Day5Leaf,-1,-1;Day6Detct "Day6Detct" true true false 80 Text 0 0,First,#,All_Sentera_w_Corrections,Day6Detct,0,80;Day6Area "Day6Area" true true false 19 Double 0 0,First,#,All_Sentera_w_Corrections,Day6Area,-1,-1;Day6Angle "Day6Angle" true true false 19 Double 0 0,First,#,All_Sentera_w_Corrections,Day6Angle,-1,-1;Day6Diam "Day6Diam" true true false 19 Double 0 0,First,#,All_Sentera_w_Corrections,Day6Diam,-1,-1;Day6Leaf "Day6Leaf" true true false 19 Double 0 0,First,#,All_Sentera_w_Corrections,Day6Leaf,-1,-1;Day9Detct "Day9Detct" true true false 80 Text 0 0,First,#,All_Sentera_w_Corrections,Day9Detct,0,80;Day9Area "Day9Area" true true false 19 Double 0 0,First,#,All_Sentera_w_Corrections,Day9Area,-1,-1;Day9Angle "Day9Angle" true true false 19 Double 0 0,First,#,All_Sentera_w_Corrections,Day9Angle,-1,-1;Day9Diam "Day9Diam" true true false 19 Double 0 0,First,#,All_Sentera_w_Corrections,Day9Diam,-1,-1;Day9Leaf "Day9Leaf" true true false 19 Double 0 0,First,#,All_Sentera_w_Corrections,Day9Leaf,-1,-1;Day13Detct "Day13Detct" true true false 80 Text 0 0,First,#,All_Sentera_w_Corrections,Day13Detct,0,80;Day13Area "Day13Area" true true false 19 Double 0 0,First,#,All_Sentera_w_Corrections,Day13Area,-1,-1;Day18Detct "Day18Detct" true true false 80 Text 0 0,First,#,All_Sentera_w_Corrections,Day18Detct,0,80;Day18Area "Day18Area" true true false 19 Double 0 0,First,#,All_Sentera_w_Corrections,Day18Area,-1,-1;Note "Note" true true false 80 Text 0 0,First,#,All_Sentera_w_Corrections,Note,0,80',
                           "INTERSECT", None, '')

import pandas as pd
from arcgis.features import GeoAccessor, GeoSeriesAccessor

layout_sentera = pd.DataFrame.spatial.from_featureclass(outfc)

layout_sentera.head(3)

file_name = os.path.join(workspace, "Digitalizing_Plots.xlsx")
field_notes = pd.read_excel(file_name)

field_notes.head(3)

sentera_field = pd.merge(layout_sentera,field_notes,how = 'left', left_on="Master_ID", right_on = "Master_ID")

sentera_field.head(3)

#Converting Excel data into a table in the working gdb 
file_name = os.path.join(workspace, "Image_Seed_Alignment.xlsx")
out_name = os.path.join(outWorkspace, "Furrow_Image_Table")
arcpy.conversion.ExcelToTable(file_name,
                              out_name,
                              '', 1, '')

#Making an XY event out of the table 
in_name = os.path.join(outWorkspace, "Furrow_Image_Table")
output_name = os.path.join(outWorkspace, "Furrow_Image_Layer")

arcpy.management.MakeXYEventLayer(in_name, 
                                  "Longitude", 
                                  "Latitude", 
                                   output_name, 
                                  'GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]];-400 -400 1000000000;-100000 10000;-100000 10000;8.98315284119521E-09;0.001;0.001;IsHighPrecision', 
                                  None)

saved_layer = os.path.join(outWorkspace, "furrow_layer.lyr")
arcpy.SaveToLayerFile_management(output_name, saved_layer)

target = os.path.join(outWorkspace,"Layout_w_Sentera")
join_f = os.path.join(outWorkspace,"Furrow_Image_Layer" )
out_file = os.path.join(outWorkspace,"Sentera_Furrow_Field")
arcpy.analysis.SpatialJoin(target,
                           join_f, 
                           out_file,
                           "JOIN_ONE_TO_ONE", 
                           "KEEP_ALL",
                           r'Join_Count "Join_Count" true true false 4 Long 0 0,First,#,Layout_w_Sentera,Join_Count,-1,-1;TARGET_FID "TARGET_FID" true true false 4 Long 0 0,First,#,Layout_w_Sentera,TARGET_FID,-1,-1;Shape_Leng "Shape_Leng" true true false 8 Double 0 0,First,#,Layout_w_Sentera,Shape_Leng,-1,-1;Master_ID "Master_ID" true true false 4 Long 0 0,First,#,Layout_w_Sentera,Master_ID,-1,-1;Plot_Numbe "Plot_Numbe" true true false 4 Long 0 0,First,#,Layout_w_Sentera,Plot_Numbe,-1,-1;Row_Number "Row_Number" true true false 4 Long 0 0,First,#,Layout_w_Sentera,Row_Number,-1,-1;Zone_Numbe "Zone_Numbe" true true false 4 Long 0 0,First,#,Layout_w_Sentera,Zone_Numbe,-1,-1;Plant_Numb "Plant_Numb" true true false 4 Long 0 0,First,#,Layout_w_Sentera,Plant_Numb,-1,-1;Descriptio "Descriptio" true true false 4 Long 0 0,First,#,Layout_w_Sentera,Descriptio,-1,-1;Shape_Le_1 "Shape_Le_1" true true false 8 Double 0 0,First,#,Layout_w_Sentera,Shape_Le_1,-1,-1;Duplicate "Duplicate" true true false 4 Long 0 0,First,#,Layout_w_Sentera,Duplicate,-1,-1;FID_1 "FID_1" true true false 8 Double 0 0,First,#,Layout_w_Sentera,FID_1,-1,-1;Row "Row" true true false 8 Double 0 0,First,#,Layout_w_Sentera,Row,-1,-1;Rep_Num "Rep_Num" true true false 8 Double 0 0,First,#,Layout_w_Sentera,Rep_Num,-1,-1;Notable "Notable" true true false 8 Double 0 0,First,#,Layout_w_Sentera,Notable,-1,-1;First_Dist "First_Dist" true true false 8 Double 0 0,First,#,Layout_w_Sentera,First_Dist,-1,-1;Last_Dist "Last_Dist" true true false 8 Double 0 0,First,#,Layout_w_Sentera,Last_Dist,-1,-1;Prev_Dist "Prev_Dist" true true false 8 Double 0 0,First,#,Layout_w_Sentera,Prev_Dist,-1,-1;Next_Dist "Next_Dist" true true false 8 Double 0 0,First,#,Layout_w_Sentera,Next_Dist,-1,-1;SNext_Dist "SNext_Dist" true true false 8 Double 0 0,First,#,Layout_w_Sentera,SNext_Dist,-1,-1;SNext_ID "SNext_ID" true true false 8 Double 0 0,First,#,Layout_w_Sentera,SNext_ID,-1,-1;SPrev_Dist "SPrev_Dist" true true false 8 Double 0 0,First,#,Layout_w_Sentera,SPrev_Dist,-1,-1;SPrev_ID "SPrev_ID" true true false 8 Double 0 0,First,#,Layout_w_Sentera,SPrev_ID,-1,-1;DNext_Dist "DNext_Dist" true true false 8 Double 0 0,First,#,Layout_w_Sentera,DNext_Dist,-1,-1;DNext_ID "DNext_ID" true true false 8 Double 0 0,First,#,Layout_w_Sentera,DNext_ID,-1,-1;DPrev_Dist "DPrev_Dist" true true false 8 Double 0 0,First,#,Layout_w_Sentera,DPrev_Dist,-1,-1;DPrev_ID "DPrev_ID" true true false 8 Double 0 0,First,#,Layout_w_Sentera,DPrev_ID,-1,-1;Day1Detct "Day1Detct" true true false 80 Text 0 0,First,#,Layout_w_Sentera,Day1Detct,0,80;Day1Area "Day1Area" true true false 8 Double 0 0,First,#,Layout_w_Sentera,Day1Area,-1,-1;Emerge "Emerge" true true false 80 Text 0 0,First,#,Layout_w_Sentera,Emerge,0,80;Day1Angle "Day1Angle" true true false 8 Double 0 0,First,#,Layout_w_Sentera,Day1Angle,-1,-1;Day1Diam "Day1Diam" true true false 8 Double 0 0,First,#,Layout_w_Sentera,Day1Diam,-1,-1;Day1Leaf "Day1Leaf" true true false 8 Double 0 0,First,#,Layout_w_Sentera,Day1Leaf,-1,-1;Day2Detct "Day2Detct" true true false 80 Text 0 0,First,#,Layout_w_Sentera,Day2Detct,0,80;Day2Area "Day2Area" true true false 8 Double 0 0,First,#,Layout_w_Sentera,Day2Area,-1,-1;Day2Angle "Day2Angle" true true false 8 Double 0 0,First,#,Layout_w_Sentera,Day2Angle,-1,-1;Day2Diam "Day2Diam" true true false 8 Double 0 0,First,#,Layout_w_Sentera,Day2Diam,-1,-1;Day2Leaf "Day2Leaf" true true false 8 Double 0 0,First,#,Layout_w_Sentera,Day2Leaf,-1,-1;Day3Detct "Day3Detct" true true false 80 Text 0 0,First,#,Layout_w_Sentera,Day3Detct,0,80;Day3Area "Day3Area" true true false 8 Double 0 0,First,#,Layout_w_Sentera,Day3Area,-1,-1;Day3Angle "Day3Angle" true true false 8 Double 0 0,First,#,Layout_w_Sentera,Day3Angle,-1,-1;Day3Diam "Day3Diam" true true false 8 Double 0 0,First,#,Layout_w_Sentera,Day3Diam,-1,-1;Day3Leaf "Day3Leaf" true true false 8 Double 0 0,First,#,Layout_w_Sentera,Day3Leaf,-1,-1;Day4Detct "Day4Detct" true true false 80 Text 0 0,First,#,Layout_w_Sentera,Day4Detct,0,80;Day4Area "Day4Area" true true false 8 Double 0 0,First,#,Layout_w_Sentera,Day4Area,-1,-1;Day4Angle "Day4Angle" true true false 8 Double 0 0,First,#,Layout_w_Sentera,Day4Angle,-1,-1;Day4Diam "Day4Diam" true true false 8 Double 0 0,First,#,Layout_w_Sentera,Day4Diam,-1,-1;Day4Leaf "Day4Leaf" true true false 8 Double 0 0,First,#,Layout_w_Sentera,Day4Leaf,-1,-1;Day5Detct "Day5Detct" true true false 80 Text 0 0,First,#,Layout_w_Sentera,Day5Detct,0,80;Day5Area "Day5Area" true true false 8 Double 0 0,First,#,Layout_w_Sentera,Day5Area,-1,-1;Day5Angle "Day5Angle" true true false 8 Double 0 0,First,#,Layout_w_Sentera,Day5Angle,-1,-1;Day5Diam "Day5Diam" true true false 8 Double 0 0,First,#,Layout_w_Sentera,Day5Diam,-1,-1;Day5Leaf "Day5Leaf" true true false 8 Double 0 0,First,#,Layout_w_Sentera,Day5Leaf,-1,-1;Day6Detct "Day6Detct" true true false 80 Text 0 0,First,#,Layout_w_Sentera,Day6Detct,0,80;Day6Area "Day6Area" true true false 8 Double 0 0,First,#,Layout_w_Sentera,Day6Area,-1,-1;Day6Angle "Day6Angle" true true false 8 Double 0 0,First,#,Layout_w_Sentera,Day6Angle,-1,-1;Day6Diam "Day6Diam" true true false 8 Double 0 0,First,#,Layout_w_Sentera,Day6Diam,-1,-1;Day6Leaf "Day6Leaf" true true false 8 Double 0 0,First,#,Layout_w_Sentera,Day6Leaf,-1,-1;Day9Detct "Day9Detct" true true false 80 Text 0 0,First,#,Layout_w_Sentera,Day9Detct,0,80;Day9Area "Day9Area" true true false 8 Double 0 0,First,#,Layout_w_Sentera,Day9Area,-1,-1;Day9Angle "Day9Angle" true true false 8 Double 0 0,First,#,Layout_w_Sentera,Day9Angle,-1,-1;Day9Diam "Day9Diam" true true false 8 Double 0 0,First,#,Layout_w_Sentera,Day9Diam,-1,-1;Day9Leaf "Day9Leaf" true true false 8 Double 0 0,First,#,Layout_w_Sentera,Day9Leaf,-1,-1;Day13Detct "Day13Detct" true true false 80 Text 0 0,First,#,Layout_w_Sentera,Day13Detct,0,80;Day13Area "Day13Area" true true false 8 Double 0 0,First,#,Layout_w_Sentera,Day13Area,-1,-1;Day18Detct "Day18Detct" true true false 80 Text 0 0,First,#,Layout_w_Sentera,Day18Detct,0,80;Day18Area "Day18Area" true true false 8 Double 0 0,First,#,Layout_w_Sentera,Day18Area,-1,-1;Note "Note" true true false 80 Text 0 0,First,#,Layout_w_Sentera,Note,0,80;Shape_Length "Shape_Length" false true true 8 Double 0 0,First,#,Layout_w_Sentera,Shape_Length,-1,-1;Shape_Area "Shape_Area" false true true 8 Double 0 0,First,#,Layout_w_Sentera,Shape_Area,-1,-1;Longitude "Longitude" true true false 8 Double 0 0,First,#,C:\Users\abe_lizbethp\Documents\DigitalAcre_LPT\516x_Project\516x_Project.gdb\Furrow_Image_Layer,Longitude,-1,-1;Latitude "Latitude" true true false 8 Double 0 0,First,#,C:\Users\abe_lizbethp\Documents\DigitalAcre_LPT\516x_Project\516x_Project.gdb\Furrow_Image_Layer,Latitude,-1,-1;Log_Name "Log Name" true true false 255 Text 0 0,First,#,C:\Users\abe_lizbethp\Documents\DigitalAcre_LPT\516x_Project\516x_Project.gdb\Furrow_Image_Layer,Log_Name,0,255;Image_Name "Image Name" true true false 255 Text 0 0,First,#,C:\Users\abe_lizbethp\Documents\DigitalAcre_LPT\516x_Project\516x_Project.gdb\Furrow_Image_Layer,Image_Name,0,255;Camera_Number "Camera Number" true true false 4 Long 0 0,First,#,C:\Users\abe_lizbethp\Documents\DigitalAcre_LPT\516x_Project\516x_Project.gdb\Furrow_Image_Layer,Camera_Number,-1,-1;Number_Of_Seeds "Number Of Seeds" true true false 4 Long 0 0,First,#,C:\Users\abe_lizbethp\Documents\DigitalAcre_LPT\516x_Project\516x_Project.gdb\Furrow_Image_Layer,Number_Of_Seeds,-1,-1',
                           "WITHIN_A_DISTANCE", "2 Inches", '')

final_file = pd.DataFrame.spatial.from_featureclass(out_file)

excel_name = os.path.join(workspace,"Sentera_Furrow_Field_Data.xlsx" )
final_file.to_excel(excel_name)


